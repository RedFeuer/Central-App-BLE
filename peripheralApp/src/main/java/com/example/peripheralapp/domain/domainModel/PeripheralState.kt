package com.example.peripheralapp.domain.domainModel

/**
 * Состояние Peripheral, которое отображается в интерфейсе.
 *
 * Назначение:
 * - хранит снимок текущего состояния GATT-сервера и рекламы;
 * - используется UI для вывода признаков работы, счётчиков подключений, подписок и последней ошибки;
 * - обновляется сервером при запуске или остановке, подключениях и изменении подписок.
 */
data class PeripheralState (
    /**
     * Поддерживается ли на устройстве периферийный режим (в частности, реклама BLE).
     *
     * `true` — поддержка есть;
     * `false` — периферийный режим или реклама недоступны (`BluetoothLeAdvertiser`).
     */
    val isSupported: Boolean = true,
    /**
     * Запущен ли сервер периферийной части.
     *
     * `true` — запущены реклама и GATT-сервер;
     * `false` — сервер остановлен, реклама выключена, соединений быть не должно.
     */
    val isRunning: Boolean = false,
    /**
     * Идёт ли сейчас отправка потока данных от Peripheral к Central.
     *
     * `true` — активна задача передачи (периодическая отправка блоков);
     * `false` — передача остановлена.
     */
    val isTransferring: Boolean = false,
    /**
     * Количество центральных устройств, которые сейчас подключены к периферийному серверу.
     *
     * Обновляется по событиям соединения или разрыва в обратных вызовах GATT-сервера.
     */
    val connectedCount: Int = 0,
    /**
     * Количество центральных устройств, подписанных на уведомления по каналу команд.
     *
     * Речь о подписке на характеристику `CMD_TX` через запись в CCCD.
     */
    val subscribedCmd: Int = 0,
    /**
     * Количество центральных устройств, подписанных на уведомления по каналу данных.
     *
     * Речь о подписке на характеристику `DATA_TX` через запись в CCCD.
     */
    val subscribedData: Int = 0,
    /**
     * Последняя ошибка, которую нужно показать в UI (если есть).
     *
     * `null` — ошибки нет или она была очищена;
     * иначе — текст ошибки для отображения.
     */
    val lastError: String? = null,
)