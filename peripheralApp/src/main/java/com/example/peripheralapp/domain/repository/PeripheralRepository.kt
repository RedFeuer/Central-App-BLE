package com.example.peripheralapp.domain.repository

import com.example.peripheralapp.domain.domainModel.PeripheralState
import kotlinx.coroutines.flow.Flow
import kotlinx.coroutines.flow.StateFlow

/**
 * Слой доступа к BLE для периферийного устройства.
 *
 * Назначение:
 * - управляет запуском и остановкой GATT-сервера и рекламы;
 * - управляет передачей данных от периферийного устройства к центральному;
 * - отдаёт наружу потоки состояния и журнала работы.
 *
 * Примечание:
 * - интерфейс описывает поведение на уровне контракта;
 * - детали реализации (через Android API) находятся в классе-реализации репозитория.
 */
interface PeripheralRepository {
    /**
     * Поток состояния периферийной части.
     *
     * Свойства:
     * - содержит последнее известное состояние;
     * - используется интерфейсом для реактивного отображения признаков работы сервера,
     *   подключений, подписок и ошибок.
     */
    val state: StateFlow<PeripheralState>
    /**
     * Поток строк журнала работы периферийной части.
     *
     * Используется для вывода диагностических сообщений в интерфейсе.
     */
    val logs: Flow<String>

    /**
     * Запускает BLE-сервер периферийного устройства.
     */
    fun startServer()
    /**
     * Останавливает BLE-сервер периферийного устройства.
     */
    fun stopServer()
    /**
     * Запускает трансфер данных от периферийного устройства к центральному.
     */
    fun startTransfer()
    /**
     * Останавливает трансфер данных от периферийного устройства к центральному.
     */
    fun stopTransfer()
    /**
     * Сбрасывает ошибку в состоянии периферийной части.
     */
    fun clearStateError()
}